<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    
    <link rel="icon" href="https://github.githubassets.com/favicons/favicon.svg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="## **SpingBoot - Maven补充**

### **一、依赖冲突**

![QQ图片20210925161432.png](/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925161432-2bd4801c2b3f4e1992be661f96a0027c.png)

**如何解决依赖冲突？**

> 方法一：默认情况下：优先保留前面先声明的版本，所以就算出现的依赖冲突但整个项目运行中是不会报错的，Maven已经自动处理好了！

> 方法二：单独为依赖库增加`dependency`指定版本号，就如依赖冲突例子可得，可以直接在dependencies中添加spring-beans的版本！

> 方法三：使用`exclusion`排除某个依赖，比如在添加spring-webmvc依赖时，使用属性标签`exclusion`排除`spring-beans`，这样`spring-beans`版本只能选择`spring-jdbc`的版本了！

> 方法四(最常用的解决方案)：使用`dependencyManagement`锁定依赖库的版本号，注意该方法只能声明版本号，不能真正下载导入依赖库！


### **二、分模块构建项目**
项目规模比较庞大时，可以考虑对项目进行拆分，分模块进行构建项目，有2种常见的拆分思路：按业务模块：员工模块、部门模块、工资模块等；按层：dao层、service层、web层等。">
<meta property="og:title" content="Spring Boot">
<meta property="og:description" content="## **SpingBoot - Maven补充**

### **一、依赖冲突**

![QQ图片20210925161432.png](/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925161432-2bd4801c2b3f4e1992be661f96a0027c.png)

**如何解决依赖冲突？**

> 方法一：默认情况下：优先保留前面先声明的版本，所以就算出现的依赖冲突但整个项目运行中是不会报错的，Maven已经自动处理好了！

> 方法二：单独为依赖库增加`dependency`指定版本号，就如依赖冲突例子可得，可以直接在dependencies中添加spring-beans的版本！

> 方法三：使用`exclusion`排除某个依赖，比如在添加spring-webmvc依赖时，使用属性标签`exclusion`排除`spring-beans`，这样`spring-beans`版本只能选择`spring-jdbc`的版本了！

> 方法四(最常用的解决方案)：使用`dependencyManagement`锁定依赖库的版本号，注意该方法只能声明版本号，不能真正下载导入依赖库！


### **二、分模块构建项目**
项目规模比较庞大时，可以考虑对项目进行拆分，分模块进行构建项目，有2种常见的拆分思路：按业务模块：员工模块、部门模块、工资模块等；按层：dao层、service层、web层等。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://shuaiwang888.github.io/appStore-Blog.github.io/post/Spring%20Boot.html">
<meta property="og:image" content="https://github.githubassets.com/favicons/favicon.svg">
<title>Spring Boot</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Spring Boot</h1>
<div class="title-right">
    <a href="https://shuaiwang888.github.io/appStore-Blog.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/shuaiwang888/appStore-Blog.github.io/issues/19" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><h2><strong>SpingBoot - Maven补充</strong></h2>
<h3><strong>一、依赖冲突</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925161432-2bd4801c2b3f4e1992be661f96a0027c.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925161432-2bd4801c2b3f4e1992be661f96a0027c.png" alt="QQ图片20210925161432.png" style="max-width: 100%;"></a></p>
<p><strong>如何解决依赖冲突？</strong></p>
<blockquote>
<p>方法一：默认情况下：优先保留前面先声明的版本，所以就算出现的依赖冲突但整个项目运行中是不会报错的，Maven已经自动处理好了！</p>
</blockquote>
<blockquote>
<p>方法二：单独为依赖库增加<code class="notranslate">dependency</code>指定版本号，就如依赖冲突例子可得，可以直接在dependencies中添加spring-beans的版本！</p>
</blockquote>
<blockquote>
<p>方法三：使用<code class="notranslate">exclusion</code>排除某个依赖，比如在添加spring-webmvc依赖时，使用属性标签<code class="notranslate">exclusion</code>排除<code class="notranslate">spring-beans</code>，这样<code class="notranslate">spring-beans</code>版本只能选择<code class="notranslate">spring-jdbc</code>的版本了！</p>
</blockquote>
<blockquote>
<p>方法四(最常用的解决方案)：使用<code class="notranslate">dependencyManagement</code>锁定依赖库的版本号，注意该方法只能声明版本号，不能真正下载导入依赖库！</p>
</blockquote>
<h3><strong>二、分模块构建项目</strong></h3>
<p>项目规模比较庞大时，可以考虑对项目进行拆分，分模块进行构建项目，有2种常见的拆分思路：按业务模块：员工模块、部门模块、工资模块等；按层：dao层、service层、web层等。</p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925162519-787f1573a7c9403782657c3045ba87fc.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925162519-787f1573a7c9403782657c3045ba87fc.png" alt="QQ图片20210925162519.png" style="max-width: 100%;"></a></p>
<p><strong>继承</strong><br>
子项目继承父项目后，可以继承父项目中的<code class="notranslate">pom.xml</code>文件中的一些内容：比如<code class="notranslate">dependencies</code>、<code class="notranslate">dependencyManagement</code>、<code class="notranslate">properties</code>等等</p>
<blockquote>
<p><strong>注意：父项目的<code class="notranslate">packaging</code>必须是<code class="notranslate">pom</code>，子项目通过<code class="notranslate">parent标签</code>继承父项目</strong></p>
</blockquote>
<p><strong>聚合</strong><br>
可以通过modules标签聚合多个项目，可以对多个项目进行统一构建管理，通常会在父项目中聚合它的子项目。</p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925162925-40e7cb8d82c249c09fcce77a153ad93d.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925162925-40e7cb8d82c249c09fcce77a153ad93d.png" alt="QQ图片20210925162925.png" style="max-width: 100%;"></a></p>
<p><strong>依赖</strong><br>
一个项目A可以使用dependency依赖另一个项目B，项目A中可以直接拥有项目B的classpath中的内容（比如类、配置文件、依赖库等），下面的代码是web项目依赖service项目：</p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925163121-0844d005f5f846f2b076de9008da4259.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925163121-0844d005f5f846f2b076de9008da4259.png" alt="QQ图片20210925163121.png" style="max-width: 100%;"></a></p>
<blockquote>
<p><strong>注意：</strong> 区别模块的继承和依赖的区别：继承是用pom.xml的配置，而依赖是用classpath中的内容。</p>
</blockquote>
<p><strong>各模块的分工：</strong></p>
<ul>
<li>父模块是进行全局定义；</li>
<li>dao模块是定义dao类、模型类等；</li>
<li>service模块是定义service类等；</li>
<li>web模块是定义controller类等；</li>
</ul>
<h2><strong>SpingBoot - 入门</strong></h2>
<h3><strong>一、简介</strong></h3>
<blockquote>
<p><strong>先从 Spring 谈起</strong></p>
</blockquote>
<p>Spring 是重量级企业开发框架 <strong>Enterprise JavaBean（EJB）</strong> 的替代品，Spring 为企业级 Java 开发提供了一种相对简单的方法，通过 <strong>依赖注入</strong> 和 <strong>面向切面编程</strong> ，用简单的 <strong>Java 对象（Plain Old Java Object，POJO）</strong> 实现了 EJB 的功能</p>
<p><strong>虽然 Spring 的组件代码是轻量级的，但它的配置却是重量级的（需要大量 XML 配置）</strong> 。</p>
<p>为此，Spring 2.5 引入了基于注解的组件扫描，这消除了大量针对应用程序自身组件的显式 XML 配置。Spring 3.0 引入了基于 Java 的配置，这是一种类型安全的可重构配置方式，可以代替 XML。</p>
<p>尽管如此，我们依旧没能逃脱配置的魔爪。开启某些 Spring 特性时，比如事务管理和 Spring MVC，还是需要用 XML 或 Java 进行显式配置。启用第三方库时也需要显式配置，比如基于 Thymeleaf 的 Web 视图。配置 Servlet 和过滤器（比如 Spring 的<code class="notranslate">DispatcherServlet</code>）同样需要在 web.xml 或 Servlet 初始化代码里进行显式配置。组件扫描减少了配置量，Java 配置让它看上去简洁不少，但 Spring 还是需要不少配置。</p>
<p>光配置这些 XML 文件都够我们头疼的了，占用了我们大部分时间和精力。除此之外，相关库的依赖非常让人头疼，不同库之间的版本冲突也非常常见。</p>
<p><strong>不过，好消息是：Spring Boot 让这一切成为了过去。</strong></p>
<blockquote>
<p><strong>再来谈谈 Spring Boot</strong></p>
</blockquote>
<p><strong>最好直白的介绍莫过于官方的介绍：</strong></p>
<blockquote>
<p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can “just run”...Most Spring Boot applications need very little Spring configuration.(Spring Boot 可以轻松创建独立的生产级基于 Spring 的应用程序,只要通过 “just run”（可能是 run ‘Application’或 java -jar 或 tomcat 或 maven 插件 run 或 shell 脚本）便可以运行项目。大部分 Spring Boot 项目只需要少量的配置即可)<br>
<strong>简而言之，从本质上来说，Spring Boot 就是 Spring，它做了那些没有它你自己也会去做的 Spring Bean 配置。</strong></p>
</blockquote>
<p><strong>为什么需要 Spring Boot?</strong></p>
<p>Spring Framework 旨在简化 J2EE 企业应用程序开发。Spring Boot Framework 旨在简化 Spring 开发。</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/9b1c09c87e3804ad236864c1e18be529e0e7c4c8f75a44650255bef9d3b644a6/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392d372f7768792d77652d6e6565642d737072696e67626f6f742e706e67"><img src="https://camo.githubusercontent.com/9b1c09c87e3804ad236864c1e18be529e0e7c4c8f75a44650255bef9d3b644a6/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392d372f7768792d77652d6e6565642d737072696e67626f6f742e706e67" alt="why-we-need-springboot" style="max-width: 100%;"></a></p>
<p><strong>Spring Boot 的主要优点</strong></p>
<ol>
<li>开发基于 Spring 的应用程序很容易。</li>
<li>Spring Boot 项目所需的开发或工程时间明显减少，通常会提高整体生产力。</li>
<li>Spring Boot 不需要编写大量样板代码、XML 配置和注释。</li>
<li>Spring 引导应用程序可以很容易地与 Spring 生态系统集成，如 Spring JDBC、Spring ORM、Spring Data、Spring Security 等。</li>
<li>Spring Boot 遵循“固执己见的默认配置”，以减少开发工作（默认配置可以修改）。</li>
<li>Spring Boot 应用程序提供嵌入式 HTTP 服务器，如 Tomcat 和 Jetty，可以轻松地开发和测试 web 应用程序。（这点很赞！普通运行 Java 程序的方式就能运行基于 Spring Boot web 项目，省事很多）</li>
<li>Spring Boot 提供命令行接口(CLI)工具，用于开发和测试 Spring Boot 应用程序，如 Java 或 Groovy。</li>
<li>Spring Boot 提供了多种插件，可以使用内置工具(如 Maven 和 Gradle)开发和测试 Spring Boot 应用程序。</li>
</ol>
<blockquote>
<p><strong>SpringBoot 开发环境要求</strong></p>
</blockquote>
<p><strong>构建工具</strong></p>
<p>构建工具(本项目涉及的代码大部分会采用 Maven 作为包管理工具):</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th><strong>Build Tool</strong></th>
<th><strong>Version</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Maven</td>
<td>3.3+</td>
</tr>
<tr>
<td>Gradle</td>
<td>4.4+</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p><strong>开发工具推荐</strong></p>
<p>推荐使用 IDEA 进行开发。最好的 Java 后台开发编辑器，没有之一！</p>
<p><strong>Web 服务器</strong></p>
<p>Spring Boot 支持以下嵌入式 servlet 容器:</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Servlet Version</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Tomcat 9.0</td>
<td>4.0</td>
</tr>
<tr>
<td>Jetty 9.4</td>
<td>3.1</td>
</tr>
<tr>
<td>Undertow 2.0</td>
<td>4.0</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p>您还可以将 Spring 引导应用程序部署到任何 Servlet 3.1+兼容的 Web 容器中。</p>
<p>这就是你为什么可以通过直接像运行 普通 Java 项目一样运行 SpringBoot 项目。这样的确省事了很多，方便了我们进行开发，降低了学习难度。</p>
<h3><strong>二、入门配置-第一个hello world</strong></h3>
<blockquote>
<p><strong>1. 新建 Spring Boot 项目</strong></p>
</blockquote>
<p><strong>①你可以通过 <a href="https://start.spring.io/" rel="nofollow">https://start.spring.io/</a> 这个网站来生成一个 Spring Boot 的项目。</strong></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/b659915064df35262bbf6c422d226e1b84d2ac0469271b21ccf2b65ca29089f1/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f696d675f636f6e766572742f36396638386236343862356639346665386661353039666334643938373035372e706e67"><img src="https://camo.githubusercontent.com/b659915064df35262bbf6c422d226e1b84d2ac0469271b21ccf2b65ca29089f1/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f696d675f636f6e766572742f36396638386236343862356639346665386661353039666334643938373035372e706e67" alt="start.spring.io" data-canonical-src="https://img-blog.csdnimg.cn/img_convert/69f88b648b5f94fe8fa509fc4d987057.png" style="max-width: 100%;"></a></p>
<p>注意勾选上 Spring Web 这个模块，这是我们所必需的一个依赖。当所有选项都勾选完毕之后，点击下方的按钮 Generate 下载这个 Spring Boot 的项目。下载完成并解压之后，我们直接使用 IDEA 打开即可。</p>
<p>另外，阿里也有一个类似的网站 <a href="https://start.aliyun.com/bootstrap.html" rel="nofollow">https://start.aliyun.com/bootstrap.html</a> ，功能甚至还要更强大点，支持生成特定应用架构的项目模板！</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/5bb43e2c5745167f699c30e7e968aa7b303116b87423d8ed922dc6b678356e83/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f32303231303432313232303235393732362e706e67"><img src="https://camo.githubusercontent.com/5bb43e2c5745167f699c30e7e968aa7b303116b87423d8ed922dc6b678356e83/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f32303231303432313232303235393732362e706e67" alt="" data-canonical-src="https://img-blog.csdnimg.cn/20210421220259726.png" style="max-width: 100%;"></a></p>
<p><strong>②你也可以直接通过 IDEA 来生成一个 Spring Boot 的项目，具体方法和上面类似：<code class="notranslate">File-&gt;New-&gt;Project-&gt;Spring Initializr</code>。</strong></p>
<blockquote>
<p><strong>2. Spring Boot 项目结构分析</strong></p>
</blockquote>
<p>成功打开项目之后，项目长下面这个样子：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2b1846470bef3d49d566f837ad59e9666b4a5f90a00ef7806d93dcd769aca8ac/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f696d675f636f6e766572742f31663161336565343033343765393431383931393838636262373263656565312e706e67237069635f63656e746572"><img src="https://camo.githubusercontent.com/2b1846470bef3d49d566f837ad59e9666b4a5f90a00ef7806d93dcd769aca8ac/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f696d675f636f6e766572742f31663161336565343033343765393431383931393838636262373263656565312e706e67237069635f63656e746572" alt="" data-canonical-src="https://img-blog.csdnimg.cn/img_convert/1f1a3ee40347e941891988cbb72ceee1.png#pic_center" style="max-width: 100%;"></a></p>
<p>以 Application 为后缀名的 Java 类一般就是 Spring Boot 的启动类，比如本项目的启动项目就是<code class="notranslate">HelloWorldApplication</code> 。我们直接像运行普通 Java 程序一样运行它，由于 Spring Boot 本身就嵌入 servlet 容器的缘故，我们的 web 项目就运行成功了， 非常方便。</p>
<p>需要注意的一点是 <strong>Spring Boot 的启动类是需要最外层的，不然可能导致一些类无法被正确扫描到，导致一些奇怪的问题。</strong> 一般情况下 Spring Boot 项目结构类似下面这样</p>
<pre class="notranslate"><code class="notranslate">com
  +- example
    +- myproject
      +- Application.java
      |
      +- domain
      |  +- Customer.java
      |  +- CustomerRepository.java
      |
      +- service
      |  +- CustomerService.java
      |
      +- controller
      |  +- CustomerController.java
      |
      +- config
      |  +- swagerConfig.java
      |
</code></pre>
<ol>
<li><code class="notranslate">Application.java</code>是项目的启动类</li>
<li>domain 目录主要用于实体（Entity）与数据访问层（Repository）</li>
<li>service 层主要是业务类代码</li>
<li>controller 负责页面访问控制</li>
<li>config 目录主要放一些配置类</li>
</ol>
<blockquote>
<p><strong>3. <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/SpringBootApplication/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/SpringBootApplication">@SpringBootApplication</a> 注解分析</strong></p>
</blockquote>
<p><code class="notranslate">HelloWorldApplication</code></p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">SpringBootApplication</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">HelloWorldApplication</span> {
	<span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">void</span> <span class="pl-en">main</span>(<span class="pl-smi">String</span>[] <span class="pl-s1">args</span>) {
		<span class="pl-smi">SpringApplication</span>.<span class="pl-en">run</span>(<span class="pl-smi">HelloWorldApplication</span>.<span class="pl-k">class</span>, <span class="pl-s1">args</span>);
	}
}</pre></div>
<p>说到 Spring Boot 启动类就不得不介绍一下 <strong><code class="notranslate">@SpringBootApplication</code> 注解</strong>了，这个注解的相关代码如下：</p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-k">package</span> <span class="pl-s1">org</span>.<span class="pl-s1">springframework</span>.<span class="pl-s1">boot</span>.<span class="pl-s1">autoconfigure</span>;
<span class="pl-c1">@</span><span class="pl-c1">Target</span>(<span class="pl-smi">ElementType</span>.<span class="pl-c1">TYPE</span>)
<span class="pl-c1">@</span><span class="pl-c1">Retention</span>(<span class="pl-smi">RetentionPolicy</span>.<span class="pl-c1">RUNTIME</span>)
<span class="pl-c1">@</span><span class="pl-c1">Documented</span>
<span class="pl-c1">@</span><span class="pl-c1">Inherited</span>
<span class="pl-c1">@</span><span class="pl-c1">SpringBootConfiguration</span>
<span class="pl-c1">@</span><span class="pl-c1">EnableAutoConfiguration</span>
<span class="pl-c1">@</span><span class="pl-c1">ComponentScan</span>(<span class="pl-s1">excludeFilters</span> = {
		<span class="pl-c1">@</span><span class="pl-c1">Filter</span>(<span class="pl-s1">type</span> = <span class="pl-smi">FilterType</span>.<span class="pl-c1">CUSTOM</span>, <span class="pl-s1">classes</span> = <span class="pl-smi">TypeExcludeFilter</span>.<span class="pl-k">class</span>),
		<span class="pl-c1">@</span><span class="pl-c1">Filter</span>(<span class="pl-s1">type</span> = <span class="pl-smi">FilterType</span>.<span class="pl-c1">CUSTOM</span>, <span class="pl-s1">classes</span> = <span class="pl-smi">AutoConfigurationExcludeFilter</span>.<span class="pl-k">class</span>) })
<span class="pl-k">public</span> @interface <span class="pl-s1">SpringBootApplication</span> {
   ......
}</pre></div>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-k">package</span> <span class="pl-s1">org</span>.<span class="pl-s1">springframework</span>.<span class="pl-s1">boot</span>;
<span class="pl-c1">@</span><span class="pl-c1">Target</span>(<span class="pl-smi">ElementType</span>.<span class="pl-c1">TYPE</span>)
<span class="pl-c1">@</span><span class="pl-c1">Retention</span>(<span class="pl-smi">RetentionPolicy</span>.<span class="pl-c1">RUNTIME</span>)
<span class="pl-c1">@</span><span class="pl-c1">Documented</span>
<span class="pl-c1">@</span><span class="pl-c1">Configuration</span>
<span class="pl-k">public</span> @interface <span class="pl-s1">SpringBootConfiguration</span> {
}</pre></div>
<p>可以看出大概可以把 <code class="notranslate">@SpringBootApplication</code>看作是 <code class="notranslate">@Configuration</code>、<code class="notranslate">@EnableAutoConfiguration</code>、<code class="notranslate">@ComponentScan</code> 注解的集合。根据 SpringBoot 官网，这三个注解的作用分别是：</p>
<ul>
<li><code class="notranslate">@EnableAutoConfiguration</code>：启用 SpringBoot 的自动配置机制，可以根据maven依赖自动构建相关环境，比如web环境等</li>
<li><code class="notranslate">@ComponentScan</code>： 扫描被<code class="notranslate">@Component</code> (<code class="notranslate">@Service</code>,<code class="notranslate">@Controller</code>)注解的 bean，注解默认会扫描该类所在的包下所有的类，所以程序入口在最外层com.ws下。</li>
<li><code class="notranslate">@Configuration</code>：允许在上下文中注册额外的 bean 或导入其他配置类，被Spring扫描到的<a class="user-mention notranslate" data-hovercard-type="organization" data-hovercard-url="/orgs/component/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/component">@component</a>都不用再加<a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/configuration/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/configuration">@configuration</a>。</li>
</ul>
<blockquote>
<p><strong>4. 新建一个 Controller</strong></p>
</blockquote>
<p>上面说了这么多，我们现在正式开始写 Spring Boot 版的 “Hello World” 吧。</p>
<p>新建一个 <code class="notranslate">controller</code> 文件夹，并在这个文件夹下新建一个名字叫做 <code class="notranslate">HelloWorldController</code> 的类。</p>
<p><code class="notranslate">@RestController</code>是 Spring 4 之后新加的注解，如果在 Spring4 之前开发 RESTful Web 服务的话，你需要使用<code class="notranslate">@Controller</code> 并结合<code class="notranslate">@ResponseBody</code>注解，也就是说<code class="notranslate">@Controller</code> +<code class="notranslate">@ResponseBody</code>= <code class="notranslate">@RestController</code>。对于这两个注解，我在基础篇单独抽了一篇文章来介绍。</p>
<p><code class="notranslate">com.example.helloworld.controller</code></p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">RestController</span>
<span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"test"</span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">HelloWorldController</span> {
    <span class="pl-c1">@</span><span class="pl-c1">GetMapping</span>(<span class="pl-s">"hello"</span>)
    <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">sayHello</span>() {
        <span class="pl-k">return</span> <span class="pl-s">"Hello World"</span>;
    }
}</pre></div>
<p>默认情况下，Spring Boot 项目会使用 8080 作为项目的端口号。如果我们修改端口号的话，非常简单，直接修改</p>
<p><code class="notranslate">application.properties</code>配置文件即可。</p>
<p><code class="notranslate">src/main/resources/application.properties</code></p>
<div class="highlight highlight-source-ini"><pre class="notranslate"><span class="pl-k">server.port</span>=8080</pre></div>
<blockquote>
<p><strong>大功告成,运行项目</strong></p>
</blockquote>
<p>运行 <code class="notranslate">HelloWorldApplication</code> ，运行成功控制台会打印出一些消息，不要忽略这些消息，它里面会有一些比较有用的信息。</p>
<pre class="notranslate"><code class="notranslate">2019-10-03 09:24:47.757  INFO 26326 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
</code></pre>
<p>上面是我截取的一段控制台打印出的内容，通过这段内容我们就知道了 Spring Boot 默认使用的 Tomact 内置 web 服务器，项目被运行在我们指定的 8080 端口上，并且项目根上下文路径是 "/"。</p>
<p>浏览器 <a href="http://localhost:8080/test/hello" rel="nofollow">http://localhost:8080/test/hello</a> 如果你可以在页面正确得到 "Hello World" 的话，说明你已经成功完成了这部分内容。</p>
<blockquote>
<p><strong>总结</strong></p>
</blockquote>
<p>通过本文我们学到了如何新建 Spring Boot 项目、SpringBoot 项目常见的项目结构分析、<code class="notranslate">@SpringBootApplication</code> 注解分析，最后实现了 Spring Boot 版的 "Hello World"。</p>
<p>执行main方法后，在浏览器输入请求：<code class="notranslate">http://localhost:8080/test</code>，会<code class="notranslate">"Hello SpringBoot"</code>;</p>
<h3><strong>三、SpringBoot项目打包成可运行jar</strong></h3>
<p>如果希望通过<code class="notranslate">mvn package</code> 打包出一个可运行的jar，需要增加一个插件：<code class="notranslate">spring-boot-maven-plugin</code></p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925170742-5ba1af5364c841269bceadd13cc5ceaa.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925170742-5ba1af5364c841269bceadd13cc5ceaa.png" alt="QQ图片20210925170742.png" style="max-width: 100%;"></a></p>
<p>也可以使用插件的run功能，直接运行SpringBoot应用。</p>
<h3><strong>四、热部署</strong></h3>
<ol>
<li>增加依赖 <code class="notranslate">spring-boot-devtools</code>（Debug模式下，它可以监控classpath的变化）</li>
</ol>
<pre class="notranslate"><code class="notranslate">        &lt;!-- 热部署(在debug模式下) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;/dependency&gt;
</code></pre>
<ol start="2">
<li>重新编译项目：手动编译（Build Project、Build Module）、自动编译（当IDEA失去焦点时，会进行自动编译，会有点延迟）</li>
</ol>
<h2><strong>SpingBoot - 配置文件</strong></h2>
<p>很多时候我们需要将一些常用的配置信息比如<code class="notranslate">阿里云oss配置</code>、<code class="notranslate">访问端口</code>、<code class="notranslate">context-path</code>、<code class="notranslate">发送短信的相关信息配置</code>等等放到配置文件中。</p>
<div class="highlight highlight-source-yaml"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span>server.port:修改端口号</span>
<span class="pl-s">server.port=8080</span>

<span class="pl-c"><span class="pl-c">#</span>设置context-path--&gt; localhost:8080/cfg/test</span>
<span class="pl-s">server.servlet.context-path=/cfg</span></pre></div>
<blockquote>
<p><strong>在之前学习中，我们在配置较简单的情况下使用了application.properties的配置文件，较复杂后我们使用application.xml的配置文件，而现在我们推出YAML类型的配置文件：</strong></p>
</blockquote>
<ul>
<li>SpringBoot更推荐用YAML作为配置文件</li>
<li>其文件拓展名为.yml</li>
<li>YAML是使用空格或TAB作为层级缩进的</li>
<li>冒号 与后面紧跟的内容之间必须要有空格或TAB</li>
<li>字符串可以不用加引号。如果有转义字符，可以使用双引号括住字符串</li>
</ul>
<blockquote>
<p><strong>为了更快捷的完成绑定工作，可以添加依赖：<code class="notranslate">spring-boot-configuration-processor</code>(配置文件属性名提示)、<code class="notranslate">lombok</code>（在编译期间帮助生成<code class="notranslate">Getter、Setter</code>，需要注意的是：<code class="notranslate">Lombok</code>仅仅在编译期间使用即可，所以<code class="notranslate">scope</code>设置为<code class="notranslate">provided</code>即可）</strong></p>
</blockquote>
<p>下面我们来看一下 Spring 为我们提供了哪些方式帮助我们从配置文件中读取这些配置信息。</p>
<p><code class="notranslate">application.yml</code> 内容如下：</p>
<div class="highlight highlight-source-yaml"><pre class="notranslate"><span class="pl-ent">wuhan2020</span>: <span class="pl-s">2020年初武汉爆发了新型冠状病毒，疫情严重，但是，我相信一切都会过去！武汉加油！中国加油！</span>
<span class="pl-ent">my-profile</span>:
  <span class="pl-ent">name</span>: <span class="pl-s">帅哥</span>
  <span class="pl-ent">email</span>: <span class="pl-s">1102733772WS@gmail.com</span>
<span class="pl-ent">library</span>:
  <span class="pl-ent">location</span>: <span class="pl-s">湖北武汉加油中国加油</span>
  <span class="pl-ent">books</span>:
    - <span class="pl-ent">name</span>: <span class="pl-s">天才基本法</span>
      <span class="pl-ent">description</span>: <span class="pl-s">二十二岁的林朝夕在父亲确诊阿尔茨海默病这天，得知自己暗恋多年的校园男神裴之即将出国深造的消息——对方考取的学校，恰是父亲当年为她放弃的那所。</span>
    - <span class="pl-ent">name</span>: <span class="pl-s">时间的秩序</span>
      <span class="pl-ent">description</span>: <span class="pl-s">为什么我们记得过去，而非未来？时间“流逝”意味着什么？是我们存在于时间之内，还是时间存在于我们之中？卡洛·罗韦利用诗意的文字，邀请我们思考这一亘古难题——时间的本质。</span>
    - <span class="pl-ent">name</span>: <span class="pl-s">了不起的我</span>
      <span class="pl-ent">description</span>: <span class="pl-s">如何养成一个新习惯？如何让心智变得更成熟？如何拥有高质量的关系？ 如何走出人生的艰难时刻？</span></pre></div>
<h3><strong>一、通过 <code class="notranslate">@value</code> 读取比较简单的配置信息</strong></h3>
<p>使用  <code class="notranslate">@Value("${property}")</code> 读取比较简单的配置信息：</p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Value</span>(<span class="pl-s">"${wuhan2020}"</span>)
<span class="pl-smi">String</span> <span class="pl-s1">wuhan2020</span>;</pre></div>
<blockquote>
<p><strong>application配置文件的内容可以直接通过<a class="user-mention notranslate" data-hovercard-type="organization" data-hovercard-url="/orgs/value/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/value">@value</a>进行注入，而且可以注入数组类型，甚至map类型（key-value），但需要注意的是 <code class="notranslate">@value</code>这种方式是不被推荐的，Spring 比较建议的是下面几种读取配置信息的方式。</strong></p>
</blockquote>
<h3><strong>二、通过<code class="notranslate">@ConfigurationProperties</code>读取并与 bean 绑定</strong></h3>
<blockquote>
<p><strong><code class="notranslate">LibraryProperties</code> 类上加了 <code class="notranslate">@Component</code> 注解，我们可以像使用普通 bean 一样将其注入到类中使用。</strong></p>
</blockquote>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Component</span>
<span class="pl-c1">@</span><span class="pl-c1">ConfigurationProperties</span>(<span class="pl-s1">prefix</span> = <span class="pl-s">"library"</span>)
<span class="pl-c1">@</span><span class="pl-c1">Setter</span>
<span class="pl-c1">@</span><span class="pl-c1">Getter</span>
<span class="pl-c1">@</span><span class="pl-c1">ToString</span>
<span class="pl-k">class</span> <span class="pl-smi">LibraryProperties</span> {
    <span class="pl-k">private</span> <span class="pl-smi">String</span> <span class="pl-s1">location</span>;
    <span class="pl-k">private</span> <span class="pl-smi">List</span>&lt;<span class="pl-smi">Book</span>&gt; <span class="pl-s1">books</span>;
    <span class="pl-c1">@</span><span class="pl-c1">Setter</span>
    <span class="pl-c1">@</span><span class="pl-c1">Getter</span>
    <span class="pl-c1">@</span><span class="pl-c1">ToString</span>
    <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-smi">Book</span> {
        <span class="pl-smi">String</span> <span class="pl-s1">name</span>;
        <span class="pl-smi">String</span> <span class="pl-s1">description</span>;
    }
}</pre></div>
<p>这个时候你就可以像使用普通 bean 一样，将其注入到类中使用：</p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c">/**</span>
<span class="pl-c"> * @author wang.shuai</span>
<span class="pl-c"> */</span>
<span class="pl-c1">@</span><span class="pl-c1">SpringBootApplication</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">ReadConfigPropertiesApplication</span> <span class="pl-k">implements</span> <span class="pl-smi">InitializingBean</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">LibraryProperties</span> <span class="pl-s1">library</span>;
    <span class="pl-k">public</span> <span class="pl-smi">ReadConfigPropertiesApplication</span>(<span class="pl-smi">LibraryProperties</span> <span class="pl-s1">library</span>) {
        <span class="pl-smi">this</span>.<span class="pl-s1">library</span> = <span class="pl-s1">library</span>;
    }
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">void</span> <span class="pl-en">main</span>(<span class="pl-smi">String</span>[] <span class="pl-s1">args</span>) {
        <span class="pl-smi">SpringApplication</span>.<span class="pl-en">run</span>(<span class="pl-smi">ReadConfigPropertiesApplication</span>.<span class="pl-k">class</span>, <span class="pl-s1">args</span>);
    }
    <span class="pl-c1">@</span><span class="pl-c1">Override</span>
    <span class="pl-k">public</span> <span class="pl-smi">void</span> <span class="pl-en">afterPropertiesSet</span>() {
        <span class="pl-smi">System</span>.<span class="pl-s1">out</span>.<span class="pl-en">println</span>(<span class="pl-s1">library</span>.<span class="pl-en">getLocation</span>());
        <span class="pl-smi">System</span>.<span class="pl-s1">out</span>.<span class="pl-en">println</span>(<span class="pl-s1">library</span>.<span class="pl-en">getBooks</span>());    }
}</pre></div>
<p>控制台输出：</p>
<pre class="notranslate"><code class="notranslate">湖北武汉加油中国加油
[LibraryProperties.Book(name=天才基本法, description........]
</code></pre>
<h3><strong>三、通过<code class="notranslate">@ConfigurationProperties</code>读取并校验</strong></h3>
<p>我们先将<code class="notranslate">application.yml</code>修改为如下内容，明显看出这不是一个正确的 email 格式：</p>
<div class="highlight highlight-source-yaml"><pre class="notranslate"><span class="pl-ent">my-profile</span>:
  <span class="pl-ent">name</span>: <span class="pl-s">帅哥</span>
  <span class="pl-ent">email</span>: <span class="pl-s">1102733772WS@gmail</span></pre></div>
<blockquote>
<p><strong><code class="notranslate">ProfileProperties</code> 类没有加 <code class="notranslate">@Component</code> 注解。我们在我们要使用<code class="notranslate">ProfileProperties</code> 的地方使用<code class="notranslate">@EnableConfigurationProperties</code>注册我们的配置bean：</strong></p>
</blockquote>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c">/**</span>
<span class="pl-c">* @author shuang.kou</span>
<span class="pl-c">*/</span>
<span class="pl-c1">@</span><span class="pl-c1">Getter</span>
<span class="pl-c1">@</span><span class="pl-c1">Setter</span>
<span class="pl-c1">@</span><span class="pl-c1">ToString</span>
<span class="pl-c1">@</span><span class="pl-c1">ConfigurationProperties</span>(<span class="pl-s">"my-profile"</span>)
<span class="pl-c1">@</span><span class="pl-c1">Validated</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">ProfileProperties</span> {
   <span class="pl-c1">@</span><span class="pl-c1">NotEmpty</span>
   <span class="pl-k">private</span> <span class="pl-smi">String</span> <span class="pl-s1">name</span>;
   <span class="pl-c1">@</span><span class="pl-c1">Email</span>
   <span class="pl-c1">@</span><span class="pl-c1">NotEmpty</span>
   <span class="pl-k">private</span> <span class="pl-smi">String</span> <span class="pl-s1">email</span>;
 
   <span class="pl-c">//配置文件中没有读取到的话就用默认值</span>
   <span class="pl-k">private</span> <span class="pl-smi">Boolean</span> <span class="pl-s1">handsome</span> = <span class="pl-smi">Boolean</span>.<span class="pl-c1">TRUE</span>;
}</pre></div>
<p>具体使用：</p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c">/**</span>
<span class="pl-c"> * @author wang.shuai</span>
<span class="pl-c"> */</span>
<span class="pl-c1">@</span><span class="pl-c1">SpringBootApplication</span>
<span class="pl-c1">@</span><span class="pl-c1">EnableConfigurationProperties</span>(<span class="pl-smi">ProfileProperties</span>.<span class="pl-k">class</span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">ReadConfigPropertiesApplication</span> <span class="pl-k">implements</span> <span class="pl-smi">InitializingBean</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">ProfileProperties</span> <span class="pl-s1">profileProperties</span>;
    <span class="pl-k">public</span> <span class="pl-smi">ReadConfigPropertiesApplication</span>(<span class="pl-smi">ProfileProperties</span> <span class="pl-s1">profileProperties</span>) {
        <span class="pl-smi">this</span>.<span class="pl-s1">profileProperties</span> = <span class="pl-s1">profileProperties</span>;
    }
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">void</span> <span class="pl-en">main</span>(<span class="pl-smi">String</span>[] <span class="pl-s1">args</span>) {
        <span class="pl-smi">SpringApplication</span>.<span class="pl-en">run</span>(<span class="pl-smi">ReadConfigPropertiesApplication</span>.<span class="pl-k">class</span>, <span class="pl-s1">args</span>);
    }
    <span class="pl-c1">@</span><span class="pl-c1">Override</span>
    <span class="pl-k">public</span> <span class="pl-smi">void</span> <span class="pl-en">afterPropertiesSet</span>() {
        <span class="pl-smi">System</span>.<span class="pl-s1">out</span>.<span class="pl-en">println</span>(<span class="pl-s1">profileProperties</span>.<span class="pl-en">toString</span>());
    }
}</pre></div>
<p>因为我们的邮箱格式不正确，所以程序运行的时候就报错，根本运行不起来，保证了数据类型的安全性：</p>
<pre lang="visual" data-meta="basic" class="notranslate"><code class="notranslate">Binding to target org.springframework.boot.context.properties.bind.BindException: Failed to bind properties under 'my-profile' to cn.javaguide.readconfigproperties.ProfileProperties failed:
    Property: my-profile.email
    Value: 1102733772WS@gmail
    Origin: class path resource [application.yml]:5:10
    Reason: must be a well-formed email address
</code></pre>
<p>我们把邮箱测试改为正确的之后再运行，控制台就能成功打印出读取到的信息：</p>
<pre class="notranslate"><code class="notranslate">ProfileProperties(name=帅哥, email=1102733772WS@gamil.com, handsome=true)
</code></pre>
<h3><strong>四、<code class="notranslate">@PropertySource</code>读取指定 properties 文件</strong></h3>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Component</span>
<span class="pl-c1">@</span><span class="pl-c1">PropertySource</span>(<span class="pl-s">"classpath:website.properties"</span>)
<span class="pl-c1">@</span><span class="pl-c1">Getter</span>
<span class="pl-c1">@</span><span class="pl-c1">Setter</span>
<span class="pl-k">class</span> <span class="pl-smi">WebSite</span> {
    <span class="pl-c1">@</span><span class="pl-c1">Value</span>(<span class="pl-s">"${url}"</span>)
    <span class="pl-k">private</span> <span class="pl-smi">String</span> <span class="pl-s1">url</span>;
}</pre></div>
<p>使用：</p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Autowired</span>
<span class="pl-k">private</span> <span class="pl-smi">WebSite</span> <span class="pl-s1">webSite</span>;
<span class="pl-smi">System</span>.<span class="pl-s1">out</span>.<span class="pl-en">println</span>(<span class="pl-s1">webSite</span>.<span class="pl-en">getUrl</span>());<span class="pl-c">//https://java.cn/</span></pre></div>
<h3><strong>五、题外话:Spring加载配置文件的优先级</strong></h3>
<p>SpringBoot默认会去加载一个应用程序配置文件名为application的文件，而且读取配置文件也是有优先级的：</p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/687-07c1ab63d50a4e12926a9bde3b873b76.png"><img src="/upload/2021/09/687-07c1ab63d50a4e12926a9bde3b873b76.png" alt="687.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925190635-272eaaeffc054bf8a17622151de846f0.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925190635-272eaaeffc054bf8a17622151de846f0.png" alt="QQ图片20210925190635.png" style="max-width: 100%;"></a></p>
<p><strong>而我们一般都是放在优先级最低的classjpath下，即resource/application.yml!</strong></p>
<p>更对内容请查看官方文档：<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config" rel="nofollow">https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config</a></p>
<h2><strong>SpingBoot - 页面模板</strong></h2>
<p>SpringBoot常见的页面模板有：JSP、Freemarker、Thymeeaf（推荐）</p>
<h3><strong>Thymeleaf</strong></h3>
<p>Thymeleaf是SpringBoot中推荐使用的页面模板引擎，其完全可以取代JSP，可以在没有服务器的环境下展示静态页面！</p>
<h3><strong>一、Thymeleaf - Hello World</strong></h3>
<p>添加依赖后再配置文件中的默认配置</p>
<pre class="notranslate"><code class="notranslate">spring:
  thymeleaf:
    encoding: UTF-8
    prefix: classpath:/tmpates/
    suffix: .html
    enabled: true
    servlet: 
      content-type: text/html
</code></pre>
<p><strong>controller：</strong></p>
<pre class="notranslate"><code class="notranslate">@Controller
public class TestController {
    // 在html文件中用${}来获取
    @GetMapping("/helloworld")
    public String helloworld(Model model) {
        model.addAttribute("name", "Larry");
        model.addAttribute("age", 22);
        model.addAttribute("msg", "&lt;h1&gt;msg&lt;/h1&gt;");
        return "01_helloworld";
    }
}
</code></pre>
<p><strong>html:</strong></p>
<pre class="notranslate"><code class="notranslate">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

This is 01_helloworld.html

&lt;div th:text="${name}"&gt;姓名&lt;/div&gt;
&lt;div th:text="${age}"&gt;年龄&lt;/div&gt;
&lt;!--这里用th:utext可以对msg的内容进行解析--&gt;
&lt;p th:utext="${msg}"&gt;消息&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><strong>总结：</strong></p>
<ul>
<li>classpath:/templates/目录下的内容只能转发访问</li>
<li>因为一些在yml的默认配置，使得返回值会加在 / 和 .html</li>
<li>在thymeleaf的控制器和html文件中，会用model.addAttribute去返回参数，而在html中用${xxx}去获取参数且th:utext会去对返回的文本解析渲染</li>
</ul>
<blockquote>
<p><strong>thymeleaf页面模板其中包括: 注释、字面量、局部变量、三目运算符、选中变量表达式、消息表达式、链接表达式、遍历、属性设置、内置对象、视图映射等等</strong></p>
</blockquote>
<h3><strong>二、Thymeleaf - 注释</strong></h3>
<p>略！</p>
<h3><strong>三、Thymeleaf - 字面量</strong></h3>
<p>controller:</p>
<pre class="notranslate"><code class="notranslate">@Controller
public class TestController {
    @GetMapping("/literal")
    public String literal(Model model) {
        model.addAttribute("name", "Larry");
        model.addAttribute("age", 22);
        return "03_literal";
    }
}
</code></pre>
<p>html:</p>
<pre class="notranslate"><code class="notranslate">&lt;body&gt;

This is 03_literal.html

&lt;div th:text="Ilovecoding."&gt;&lt;/div&gt;
&lt;div th:text="${name} + ' love coding.' + ${age}"&gt;&lt;/div&gt;
&lt;div th:text="${name} + | love coding.|"&gt;&lt;/div&gt;

&lt;div th:text="'${name} love coding.'"&gt;&lt;/div&gt;
&lt;div th:text="|${name} love coding.|"&gt;&lt;/div&gt;

&lt;div th:text="${age} % 2"&gt;&lt;/div&gt;

&lt;hr&gt;

&lt;div th:text="${name} ? '存在name' : '不存在name'"&gt;&lt;/div&gt;

&lt;!--with定义局部变量--&gt;
&lt;div th:with="id=10, salary=200, nickName='SS'"&gt;
    &lt;div th:text="'id = ' + ${id}"&gt;&lt;/div&gt;
    &lt;div th:text="'salary = ' + ${salary}"&gt;&lt;/div&gt;
    &lt;div th:text="'nickName = ' + ${nickName}"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!--th:class会做逻辑三目运算符运算--&gt;
&lt;div th:class="${age % 2 == 0} ? 'blue' : 'red'"&gt;
    div666
&lt;/div&gt;

&lt;div th:text="${age} ? ${age} : 'No Age'"&gt;

&lt;/div&gt;

&lt;div th:text="${age} ?: 'No Age'"&gt;

&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194944-89e49326714a45a98635d2ed48a0c7fe.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194944-89e49326714a45a98635d2ed48a0c7fe.png" alt="QQ图片20210925194944.png" style="max-width: 100%;"></a></p>
<h3><strong>四、Thymeleaf - 局部变量、三目运算</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194948-fd30597b76bf457c961e541a033ef658.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194948-fd30597b76bf457c961e541a033ef658.png" alt="QQ图片20210925194948.png" style="max-width: 100%;"></a></p>
<h3><strong>五、Thymeleaf - 选中变量表达式</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194952-56f3c08696c44d3cae82d94ea0410d44.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194952-56f3c08696c44d3cae82d94ea0410d44.png" alt="QQ图片20210925194952.png" style="max-width: 100%;"></a></p>
<h3><strong>六、Thymeleaf - 消息表达式</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194955-aaa91e2efe9d4936b131785cf2c7bf78.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925194955-aaa91e2efe9d4936b131785cf2c7bf78.png" alt="QQ图片20210925194955.png" style="max-width: 100%;"></a></p>
<h3><strong>七、Thymeleaf - 链接表达式</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925195000-a11cfdd894f34b95b19b767403031e99.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925195000-a11cfdd894f34b95b19b767403031e99.png" alt="QQ图片20210925195000.png" style="max-width: 100%;"></a></p>
<h3><strong>八、Thymeleaf - 遍历</strong></h3>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925195003-fdeab61e13694c38831de6dbe3666f63.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925195003-fdeab61e13694c38831de6dbe3666f63.png" alt="QQ图片20210925195003.png" style="max-width: 100%;"></a></p>
<h3><strong>九、Thymeleaf - 内置对象</strong></h3>
<blockquote>
<p><strong>基础对象：</strong><br>
#ctx、<br>
#vars、<br>
#locale、<br>
#request：HttpServletRequest、<br>
#response：HttpServletResponse、<br>
#session、session：HttpSession、<br>
#servletContext、application：ServletContext</p>
</blockquote>
<blockquote>
<p><strong>工具对象：</strong><br>
#messages<br>
#uris<br>
#dates<br>
#numbers、#strings、#objects、#bools、#arrays、#list、#sets、#maps等</p>
</blockquote>
<h3><strong>十、视图映射</strong></h3>
<p>对于视图映射，默认情况下会把<code class="notranslate">index</code>视图当做首页，当然了我们可以在<code class="notranslate">SpringMVCConfig</code>中实现<code class="notranslate">WebMvcConfigurer</code>，来自定义视图映射:</p>
<p><strong>SpringMVCConfig:</strong></p>
<pre class="notranslate"><code class="notranslate">// 修改默认配置：如首页
@Configuration
public class SpringMVCConfig implements WebMvcConfigurer {
    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
        // 首页的映射
        registry.addViewController("/").setViewName("login");

        // 其他页面的映射
        // 请求到/comment就是映射到02_comment后拼接出来的url-&gt;{ctx}02_comment.html
        registry.addViewController("/comment").setViewName("02_comment");
//        registry.addViewController("/comment/").setViewName("02_comment");

        registry.addViewController("/i18n").setViewName("05_i18n");
//        registry.addViewController("/i18n/").setViewName("05_i18n");
    }
}
</code></pre>
<p><code class="notranslate">registry.addViewController("/xxx").setViewName("yyy");</code> 当请求xxx时就会跳转到<code class="notranslate">classpath:/yyy</code>；也可以设置首页(请求/)，直接转发到对应页面，这样就可以省去在控制器中的转发代码！</p>
<h2><strong>SpingBoot - MyBatis</strong></h2>
<p><strong>SpringBoot 整合 Mybatis 有两种常用的方式，一种就是我们常见的 <code class="notranslate">xml</code> 的方式 ，还有一种是<code class="notranslate">全注解</code>的方式。我觉得这两者没有谁比谁好，在 SQL 语句不太长的情况下，我觉得全注解的方式一定是比较清晰简洁的。但是，复杂的 SQL 确实不太适合和代码写在一起。</strong></p>
<p>下面就开始吧！</p>
<h3><strong>一、 开发前的准备</strong></h3>
<blockquote>
<p><strong>环境参数</strong></p>
</blockquote>
<ul>
<li>开发工具：IDEA</li>
<li>基础工具：Maven+JDK8</li>
<li>所用技术：SpringBoot+Mybatis</li>
<li>数据库：MySQL</li>
<li>SpringBoot版本：2.1.0</li>
</ul>
<blockquote>
<p><strong>创建工程</strong></p>
</blockquote>
<p>创建一个基本的 SpringBoot 项目，我这里就不多说这方面问题了，具体可以参考前面的文章。</p>
<blockquote>
<p><strong>创建数据库和 user 用户表</strong></p>
</blockquote>
<p>我们的用户表很简单，只有 4 个字段：用户 id、姓名、年龄、余额，如下图所示：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/c76b0a0ecfe292bea5808f44bab06e2731c6486c7798b70365fbc09d2bbe6817/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f39393234383036302e6a7067"><img src="https://camo.githubusercontent.com/c76b0a0ecfe292bea5808f44bab06e2731c6486c7798b70365fbc09d2bbe6817/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f39393234383036302e6a7067" alt="表信息" style="max-width: 100%;"></a></p>
<p>添加了“余额money”字段是为了给大家简单的演示一下事务管理的方式。</p>
<p><strong>建表语句：</strong></p>
<div class="highlight highlight-source-sql"><pre class="notranslate"><span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> `<span class="pl-en">user</span>` (
  <span class="pl-s"><span class="pl-pds">`</span>id<span class="pl-pds">`</span></span> <span class="pl-k">int</span>(<span class="pl-c1">13</span>) <span class="pl-k">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="pl-s"><span class="pl-pds">'</span>主键<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">`</span>name<span class="pl-pds">`</span></span> <span class="pl-k">varchar</span>(<span class="pl-c1">33</span>) DEFAULT <span class="pl-k">NULL</span> COMMENT <span class="pl-s"><span class="pl-pds">'</span>姓名<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">`</span>age<span class="pl-pds">`</span></span> <span class="pl-k">int</span>(<span class="pl-c1">3</span>) DEFAULT <span class="pl-k">NULL</span> COMMENT <span class="pl-s"><span class="pl-pds">'</span>年龄<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">`</span>money<span class="pl-pds">`</span></span> double DEFAULT <span class="pl-k">NULL</span> COMMENT <span class="pl-s"><span class="pl-pds">'</span>账户余额<span class="pl-pds">'</span></span>,
  <span class="pl-k">PRIMARY KEY</span> (<span class="pl-s"><span class="pl-pds">`</span>id<span class="pl-pds">`</span></span>)
) ENGINE<span class="pl-k">=</span>InnoDB AUTO_INCREMENT<span class="pl-k">=</span><span class="pl-c1">5</span> DEFAULT CHARSET<span class="pl-k">=</span>utf8</pre></div>
<blockquote>
<p><strong>配置 pom 文件中的相关依赖</strong></p>
</blockquote>
<p>由于要整合 springboot 和 mybatis 所以加入了artifactId 为 <code class="notranslate">mybatis-spring-boot-starter</code> 的依赖，由于使用了Mysql 数据库 所以加入了artifactId 为 <code class="notranslate">mysql-connector-java</code> 的依赖。</p>
<div class="highlight highlight-text-xml"><pre class="notranslate">    &lt;<span class="pl-ent">dependencies</span>&gt;
        &lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;org.springframework.boot&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;spring-boot-starter-web&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;/<span class="pl-ent">dependency</span>&gt;
        &lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;org.mybatis.spring.boot&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;mybatis-spring-boot-starter&lt;/<span class="pl-ent">artifactId</span>&gt;
            &lt;<span class="pl-ent">version</span>&gt;1.3.2&lt;/<span class="pl-ent">version</span>&gt;
        &lt;/<span class="pl-ent">dependency</span>&gt;
        &lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;mysql&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;mysql-connector-java&lt;/<span class="pl-ent">artifactId</span>&gt;
            &lt;<span class="pl-ent">scope</span>&gt;runtime&lt;/<span class="pl-ent">scope</span>&gt;
        &lt;/<span class="pl-ent">dependency</span>&gt;
        &lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;org.springframework.boot&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;spring-boot-starter-test&lt;/<span class="pl-ent">artifactId</span>&gt;
            &lt;<span class="pl-ent">scope</span>&gt;test&lt;/<span class="pl-ent">scope</span>&gt;
        &lt;/<span class="pl-ent">dependency</span>&gt;
    &lt;/<span class="pl-ent">dependencies</span>&gt;</pre></div>
<blockquote>
<p><strong>配置 application.properties</strong></p>
</blockquote>
<p>由于我使用的是比较新的Mysql连接驱动，所以配置文件可能和之前有一点不同。</p>
<div class="highlight highlight-source-ini"><pre class="notranslate"><span class="pl-k">server.port</span>=8333
<span class="pl-k">spring.datasource.url</span>=jdbc:mysql://127.0.0.1:3306/erp?<span class="pl-k">useUnicode</span>=true&amp;<span class="pl-k">characterEncoding</span>=utf8&amp;<span class="pl-k">useSSL</span>=false&amp;<span class="pl-k">serverTimezone</span>=GMT%2B8
<span class="pl-k">spring.datasource.username</span>=root
<span class="pl-k">spring.datasource.password</span>=root
<span class="pl-k">spring.datasource.driver-class-name</span>=com.mysql.cj.jdbc.Driver</pre></div>
<p>注意：我们使用的 mysql-connector-java 8+ ，JDBC 连接到mysql-connector-java 6+以上的需要指定时区 <code class="notranslate">serverTimezone=GMT%2B8</code>。另外我们之前使用配置 Mysql数据连接是一般是这样指定<code class="notranslate">driver-class-name=com.mysql.jdbc.Driver</code>,但是现在不可以必须为 否则控制台下面的异常：</p>
<pre lang="error" class="notranslate"><code class="notranslate">Loading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.
</code></pre>
<p>上面异常的意思是：<code class="notranslate">com.mysql.jdbc.Driver</code> 被弃用了。新的驱动类是 <code class="notranslate">com.mysql.cj.jdbc.Driver</code>。驱动程序通过SPI自动注册，手动加载类通常是不必要。</p>
<p>如果你非要写把<code class="notranslate">com.mysql.jdbc.Driver</code> 改为<code class="notranslate">com.mysql.cj.jdbc.Driver </code>即可。</p>
<blockquote>
<p><strong>创建用户类 Bean</strong></p>
</blockquote>
<p><strong>User.java</strong></p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">User</span> {
    <span class="pl-k">private</span> <span class="pl-smi">int</span> <span class="pl-s1">id</span>;
    <span class="pl-k">private</span> <span class="pl-smi">String</span> <span class="pl-s1">name</span>;
    <span class="pl-k">private</span> <span class="pl-smi">int</span> <span class="pl-s1">age</span>;
    <span class="pl-k">private</span> <span class="pl-smi">double</span> <span class="pl-s1">money</span>;
    ...
    <span class="pl-smi">此处省略getter</span>、<span class="pl-s1">setter以及</span> <span class="pl-s1">toString方法</span>
}</pre></div>
<h3><strong>二、全注解的方式</strong></h3>
<p>先来看一下 全注解的方式，这种方式和后面提到的 xml 的方式的区别仅仅在于：一个将 sql 语句写在 java 代码中，一个写在 xml 配置文件中。全注方式解转换成 xml 方式仅需做一点点改变即可，我在后面会提到。</p>
<p><strong>项目结构：</strong></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/4b80a56f03f3f136e6f664e2ee2884c29bda73fa721eb58694e87b9f784df275/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f313930393931302e6a7067"><img src="https://camo.githubusercontent.com/4b80a56f03f3f136e6f664e2ee2884c29bda73fa721eb58694e87b9f784df275/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f313930393931302e6a7067" alt="全注解方式项目结构" style="max-width: 100%;"></a></p>
<blockquote>
<p><strong>Dao 层开发</strong></p>
</blockquote>
<p><strong>UserDao.java</strong></p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Mapper</span>
<span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-smi">UserDao</span> {
    <span class="pl-c">/**</span>
<span class="pl-c">     * 通过名字查询用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Select</span>(<span class="pl-s">"SELECT * FROM user WHERE name = #{name}"</span>)
    <span class="pl-smi">User</span> <span class="pl-en">findUserByName</span>(<span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"name"</span>) <span class="pl-smi">String</span> <span class="pl-s1">name</span>);
    <span class="pl-c">/**</span>
<span class="pl-c">     * 查询所有用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Select</span>(<span class="pl-s">"SELECT * FROM user"</span>)
    <span class="pl-smi">List</span>&lt;<span class="pl-smi">User</span>&gt; <span class="pl-en">findAllUser</span>();
    <span class="pl-c">/**</span>
<span class="pl-c">     * 插入用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Insert</span>(<span class="pl-s">"INSERT INTO user(name, age,money) VALUES(#{name}, #{age}, #{money})"</span>)
    <span class="pl-smi">void</span> <span class="pl-en">insertUser</span>(<span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"name"</span>) <span class="pl-smi">String</span> <span class="pl-s1">name</span>, <span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"age"</span>) <span class="pl-smi">Integer</span> <span class="pl-s1">age</span>, <span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"money"</span>) <span class="pl-smi">Double</span> <span class="pl-s1">money</span>);
    <span class="pl-c">/**</span>
<span class="pl-c">     * 根据 id 更新用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Update</span>(<span class="pl-s">"UPDATE  user SET name = #{name},age = #{age},money= #{money} WHERE id = #{id}"</span>)
    <span class="pl-smi">void</span> <span class="pl-en">updateUser</span>(<span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"name"</span>) <span class="pl-smi">String</span> <span class="pl-s1">name</span>, <span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"age"</span>) <span class="pl-smi">Integer</span> <span class="pl-s1">age</span>, <span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"money"</span>) <span class="pl-smi">Double</span> <span class="pl-s1">money</span>,
                    <span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"id"</span>) <span class="pl-smi">int</span> <span class="pl-s1">id</span>);
    <span class="pl-c">/**</span>
<span class="pl-c">     * 根据 id 删除用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Delete</span>(<span class="pl-s">"DELETE from user WHERE id = #{id}"</span>)
    <span class="pl-smi">void</span> <span class="pl-en">deleteUser</span>(<span class="pl-c1">@</span><span class="pl-c1">Param</span>(<span class="pl-s">"id"</span>) <span class="pl-smi">int</span> <span class="pl-s1">id</span>);
}</pre></div>
<blockquote>
<p><strong>service 层</strong></p>
</blockquote>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Service</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">UserService</span> {
    <span class="pl-c1">@</span><span class="pl-c1">Autowired</span>
    <span class="pl-k">private</span> <span class="pl-smi">UserDao</span> <span class="pl-s1">userDao</span>;
    <span class="pl-c">/**</span>
<span class="pl-c">     * 根据名字查找用户</span>
<span class="pl-c">     */</span>
    <span class="pl-k">public</span> <span class="pl-smi">User</span> <span class="pl-en">selectUserByName</span>(<span class="pl-smi">String</span> <span class="pl-s1">name</span>) {
        <span class="pl-k">return</span> <span class="pl-s1">userDao</span>.<span class="pl-en">findUserByName</span>(<span class="pl-s1">name</span>);
    }
    <span class="pl-c">/**</span>
<span class="pl-c">     * 查找所有用户</span>
<span class="pl-c">     */</span>
    <span class="pl-k">public</span> <span class="pl-smi">List</span>&lt;<span class="pl-smi">User</span>&gt; <span class="pl-en">selectAllUser</span>() {
        <span class="pl-k">return</span> <span class="pl-s1">userDao</span>.<span class="pl-en">findAllUser</span>();
    }
    <span class="pl-c">/**</span>
<span class="pl-c">     * 插入两个用户</span>
<span class="pl-c">     */</span>
    <span class="pl-k">public</span> <span class="pl-smi">void</span> <span class="pl-en">insertService</span>() {
        <span class="pl-s1">userDao</span>.<span class="pl-en">insertUser</span>(<span class="pl-s">"SnailClimb"</span>, <span class="pl-c1">22</span>, <span class="pl-c1">3000.0</span>);
        <span class="pl-s1">userDao</span>.<span class="pl-en">insertUser</span>(<span class="pl-s">"Daisy"</span>, <span class="pl-c1">19</span>, <span class="pl-c1">3000.0</span>);
    }
    <span class="pl-c">/**</span>
<span class="pl-c">     * 根据id 删除用户</span>
<span class="pl-c">     */</span>
    <span class="pl-k">public</span> <span class="pl-smi">void</span> <span class="pl-en">deleteService</span>(<span class="pl-smi">int</span> <span class="pl-s1">id</span>) {
        <span class="pl-s1">userDao</span>.<span class="pl-en">deleteUser</span>(<span class="pl-s1">id</span>);
    }
    <span class="pl-c">/**</span>
<span class="pl-c">     * 模拟事务。由于加上了 @Transactional注解，如果转账中途出了意外 SnailClimb 和 Daisy 的钱都不会改变。</span>
<span class="pl-c">     */</span>
    <span class="pl-c1">@</span><span class="pl-c1">Transactional</span>
    <span class="pl-k">public</span> <span class="pl-smi">void</span> <span class="pl-en">changemoney</span>() {
        <span class="pl-s1">userDao</span>.<span class="pl-en">updateUser</span>(<span class="pl-s">"SnailClimb"</span>, <span class="pl-c1">22</span>, <span class="pl-c1">2000.0</span>, <span class="pl-c1">3</span>);
        <span class="pl-c">// 模拟转账过程中可能遇到的意外状况</span>
        <span class="pl-smi">int</span> <span class="pl-s1">temp</span> = <span class="pl-c1">1</span> / <span class="pl-c1">0</span>;
        <span class="pl-s1">userDao</span>.<span class="pl-en">updateUser</span>(<span class="pl-s">"Daisy"</span>, <span class="pl-c1">19</span>, <span class="pl-c1">4000.0</span>, <span class="pl-c1">4</span>);
    }
}</pre></div>
<blockquote>
<p><strong>Controller 层</strong></p>
</blockquote>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">RestController</span>
<span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"/user"</span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">UserController</span> {
    <span class="pl-c1">@</span><span class="pl-c1">Autowired</span>
    <span class="pl-k">private</span> <span class="pl-smi">UserService</span> <span class="pl-s1">userService</span>;
    <span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"/query"</span>)
    <span class="pl-k">public</span> <span class="pl-smi">User</span> <span class="pl-en">testQuery</span>() {
        <span class="pl-k">return</span> <span class="pl-s1">userService</span>.<span class="pl-en">selectUserByName</span>(<span class="pl-s">"Daisy"</span>);
    }
    <span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"/insert"</span>)
    <span class="pl-k">public</span> <span class="pl-smi">List</span>&lt;<span class="pl-smi">User</span>&gt; <span class="pl-en">testInsert</span>() {
        <span class="pl-s1">userService</span>.<span class="pl-en">insertService</span>();
        <span class="pl-k">return</span> <span class="pl-s1">userService</span>.<span class="pl-en">selectAllUser</span>();
    }
    <span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"/changemoney"</span>)
    <span class="pl-k">public</span> <span class="pl-smi">List</span>&lt;<span class="pl-smi">User</span>&gt; <span class="pl-en">testchangemoney</span>() {
        <span class="pl-s1">userService</span>.<span class="pl-en">changemoney</span>();
        <span class="pl-k">return</span> <span class="pl-s1">userService</span>.<span class="pl-en">selectAllUser</span>();
    }
    <span class="pl-c1">@</span><span class="pl-c1">RequestMapping</span>(<span class="pl-s">"/delete"</span>)
    <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">testDelete</span>() {
        <span class="pl-s1">userService</span>.<span class="pl-en">deleteService</span>(<span class="pl-c1">3</span>);
        <span class="pl-k">return</span> <span class="pl-s">"OK"</span>;
    }
}</pre></div>
<blockquote>
<p><strong>启动类</strong></p>
</blockquote>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c">//此注解表示SpringBoot启动类</span>
<span class="pl-c1">@</span><span class="pl-c1">SpringBootApplication</span>
<span class="pl-c">// 此注解表示动态扫描DAO接口所在包，实际上不加下面这条语句也可以找到</span>
<span class="pl-c1">@</span><span class="pl-c1">MapperScan</span>(<span class="pl-s">"top.snailclimb.dao"</span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-smi">MainApplication</span> {
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">void</span> <span class="pl-en">main</span>(<span class="pl-smi">String</span>[] <span class="pl-s1">args</span>) {
        <span class="pl-smi">SpringApplication</span>.<span class="pl-en">run</span>(<span class="pl-smi">MainApplication</span>.<span class="pl-k">class</span>, <span class="pl-s1">args</span>);
    }
}</pre></div>
<blockquote>
<p><strong>简单测试</strong></p>
</blockquote>
<p>上述代码经过测试都没问题，这里贴一下根据姓名查询的测试的结果。</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/9528d7db612b397853dc4c2897e7ad5bfb31a252f2d80527d56034ffa9ba2150/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f39323833343932302e6a7067"><img src="https://camo.githubusercontent.com/9528d7db612b397853dc4c2897e7ad5bfb31a252f2d80527d56034ffa9ba2150/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f39323833343932302e6a7067" alt="根据姓名查询的测试的结果" style="max-width: 100%;"></a></p>
<h3><strong>三、xml 的方式</strong></h3>
<p><strong>项目结构：</strong><br>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/edcb1349a82f8762db902a4b5ac87f818d3ccbae2f6cefe380465180329f1b02/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f3438353439322e6a7067"><img src="https://camo.githubusercontent.com/edcb1349a82f8762db902a4b5ac87f818d3ccbae2f6cefe380465180329f1b02/687474703a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f31382d31312d32392f3438353439322e6a7067" alt="项目结构" style="max-width: 100%;"></a></p>
<p>相比于注解的方式主要有以下几点改变，非常容易实现。</p>
<blockquote>
<p><strong>Dao 层的改动</strong></p>
</blockquote>
<p>我这里只演示一个根据姓名找人的方法。</p>
<p><strong>UserDao.java</strong></p>
<div class="highlight highlight-source-java"><pre class="notranslate"><span class="pl-c1">@</span><span class="pl-c1">Mapper</span>
<span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-smi">UserDao</span> {
    <span class="pl-c">/**</span>
<span class="pl-c">     * 通过名字查询用户信息</span>
<span class="pl-c">     */</span>
    <span class="pl-smi">User</span> <span class="pl-en">findUserByName</span>(<span class="pl-smi">String</span> <span class="pl-s1">name</span>);
}</pre></div>
<p><strong>UserMapper.xml</strong></p>
<div class="highlight highlight-text-xml"><pre class="notranslate">&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">mapper</span> PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;

&lt;<span class="pl-ent">mapper</span> <span class="pl-e">namespace</span>=<span class="pl-s"><span class="pl-pds">"</span>top.snailclimb.dao.UserDao<span class="pl-pds">"</span></span>&gt;

    &lt;<span class="pl-ent">select</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>findUserByName<span class="pl-pds">"</span></span> <span class="pl-e">parameterType</span>=<span class="pl-s"><span class="pl-pds">"</span>String<span class="pl-pds">"</span></span> <span class="pl-e">resultType</span>=<span class="pl-s"><span class="pl-pds">"</span>top.snailclimb.bean.User<span class="pl-pds">"</span></span>&gt;
        SELECT * FROM user WHERE name = #{name}
    &lt;/<span class="pl-ent">select</span>&gt;
&lt;/<span class="pl-ent">mapper</span>&gt;
</pre></div>
<blockquote>
<p><strong>配置文件的改动</strong></p>
</blockquote>
<p>配置文件中加入下面这句话：</p>
<p><code class="notranslate">mybatis.mapper-locations=classpath:mapper/*.xml</code></p>
<h2><strong>SpringBoot - 日志处理</strong></h2>
<p>SpringBoot一般推荐<strong>SLF4J（门面接口）</strong> + <strong>logback（具体实现）或者 Log4j 2</strong> 进行日志处理！</p>
<h3><strong>一、日志的作用</strong></h3>
<ol>
<li>在开发调试过程中，进行逻辑跟踪、查看运行结果</li>
<li>辅助排查和定位线上问题，优化程序运行性能</li>
<li>监控系统的运行状态、检测非授权的操作</li>
<li>日志中蕴含了大量的用户数据，包括点击行为，兴趣偏好等</li>
</ol>
<h3><strong>二、日志的发展</strong></h3>
<p>最原始 -&gt; JUL -&gt; Log4j -&gt; JCL -&gt; SLF4J -&gt; Logback -&gt; Log4j2</p>
<p><strong>总结：</strong></p>
<p><a target="_blank" rel="noopener noreferrer" href="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925202659-04d77796b85c404ca0ab9f8c01b950ad.png"><img src="/upload/2021/09/QQ%E5%9B%BE%E7%89%8720210925202659-04d77796b85c404ca0ab9f8c01b950ad.png" alt="QQ图片20210925202659.png" style="max-width: 100%;"></a></p>
<p>略！</p></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://shuaiwang888.github.io/appStore-Blog.github.io">Blog Title</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","shuaiwang888/appStore-Blog.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>


</html>
