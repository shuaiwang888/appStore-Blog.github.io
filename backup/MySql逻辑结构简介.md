**今天安装了数据库，系统学习mysql数据库的底层结构！**

**结构示意图：**

![image.png](/upload/2022/01/image-369162918f234105b19c2c3aecb6dc1c.png)

**如上图，可把数据库的结构分成四层，见下图及文字说明：**

![image.png](/upload/2022/01/image-c8af28dc8134459bac1158c755bc3cab.png)

**简洁图**

![](https://img-blog.csdnimg.cn/b776572121094706ad0c4a0de0240b16.png)

### 一、连接层
- 提供客户端和连接服务，包含本地Sock通信和大多数基于客户端/服务端工具实现的**类似于TCP/IP的通信**，主要完成一些类似于**连接处理、授权认证、及相关的安全方案**，在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程，同样在该层上可以实现基于SSL的安全链接。
- 服务器也会为安全接入的每个客户端验证它所具有的操作权限。
- **注：分配数据库连接线程池，控制数据库的连接和关闭等资源。**

### 二、业务逻辑处理层
- 主要完成大多数的核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化及部分内置函数的操作。
- 分析器：首先**语词分析**，你的语句有这么多单词、空格，MySQL就需要识别每个字符串所代表的是什么，是关键字，还是表名，还是列名等等。然后就开始**语法分析**，根据词法分析的结果，语法分析会判断你sql的对错，错了会提醒你的，并且会提示你哪里错了。
- 优化器：首先因为我们建立表可能会建立很多索引，优化有一步就是**要确认使用哪个索引**，比如使用你的主键索引，联合索引还是什么索引更好。还有就是对**执行顺序进行优化**，条件那么多，先查哪个表，还是先关联，会出现很多方案，最后由优化器决定选用哪种方案。
- 所有跨操作引擎的功能也在这一层实现，如过程，函数等。在该层服务器会解析查询并创建相应的内部解析树，并对其完成相应的优化如确定查询表的顺序，是否利用索引等，最后生成相应的执行操作。
- 如果是SELECT语句，服务器还会查询内部的缓存，如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统的性能。
- **注：提供SQL操作的接口，对SQL脚本按一定规则进行解析，并通过SQL优化器优化执行顺序，对于查询的语句还会进入缓存区，提升系统的性能。**

### 三、数据存储引擎层
- 存储引擎真正的负责了MySQL中数据的存储和提取，服务器通过API与存储引擎进行通信，不同的存储引擎具有的功能不同，这样我们可以根据自己的实际需要进行选选取。
- **注：存储引擎都是可插拔的，每个存储引擎所提供的服务都有所差异，所以我们需要根据具体的业务需要，选择合适的存储引擎，常用的只有两种MyISAM和InnoDB。**

### 四、数据存储层
- 主要是将数据存储在运行于裸设备的文件系统上，并完成与存储引擎的交互。
- **注：将数据存储到磁盘上，并协同存储引擎对数据进行读写操作。**

### 总结

[可以康康另一篇文章：一条SQL语句在MySQL中的执行流程](http://121.199.72.143:8090/archives/%E4%B8%80%E6%9D%A1sql%E8%AF%AD%E5%8F%A5%E5%9C%A8mysql%E4%B8%AD%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B)